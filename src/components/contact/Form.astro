<div
  class="lg:col-span-7 bg-white py-5 px-3 sm:p-10 rounded-4xl shadow-2xl shadow-slate-200 border border-white"
>
  <div class="mb-8">
    <h3 class="font-heading text-2xl font-bold text-foreground mb-2">
      Envíanos un mensaje
    </h3>
    <p class="text-foreground-muted text-md font-body">
      Completa el formulario y te responderemos en breve.
    </p>
  </div>

  <form class="space-y-5" id="contact-form">
    <div class="space-y-1">
      <label
        for="name"
        class="font-body text-xs md:text-md font-bold uppercase text-foreground-muted ml-2"
        >Nombre</label
      >
      <input
        type="text"
        id="name"
        name="name"
        placeholder="Tu nombre completo"
        required
        class="font-body md:text-md w-full bg-slate-50 border border-slate-100 rounded-xl px-5 py-4 focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all text-foreground font-medium placeholder:text-gray-400"
      />
    </div>

    <div class="space-y-1">
      <label
        for="email"
        class="font-body md:text-md text-xs font-bold uppercase text-foreground-muted ml-2"
        >Correo</label
      >
      <input
        type="email"
        id="email"
        name="email"
        placeholder="ejemplo@correo.com"
        required
        class="font-body md:text-md w-full bg-slate-50 border border-slate-100 rounded-xl px-5 py-4 focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all text-foreground font-medium placeholder:text-gray-400"
      />
    </div>

    <div class="space-y-1">
      <label
        for="subject"
        class="text-xs md:text-md font-body font-bold uppercase text-foreground-muted ml-2"
        >Asunto</label
      >
      <input
        type="text"
        id="subject"
        name="subject"
        placeholder="¿Motivo de tu consulta?"
        required
        class="w-full md:text-md font-body bg-slate-50 border border-slate-100 rounded-xl px-5 py-4 focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all text-foreground font-medium placeholder:text-gray-400"
      />
    </div>

    <div class="space-y-1">
      <label
        for="message"
        class="text-xs md:text-md font-body font-bold uppercase text-foreground-muted ml-2"
        >Mensaje</label
      >
      <textarea
        id="message"
        name="message"
        rows="4"
        placeholder="Escribe tu mensaje aquí..."
        required
        class="w-full md:text-md font-body bg-slate-50 border border-slate-100 rounded-xl px-5 py-4 focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all text-foreground font-medium resize-none placeholder:text-gray-400"
      ></textarea>
    </div>

    <!-- Mensaje de éxito o error -->
    <div id="form-message" class="hidden">
      <!-- Se llenado dinámicamente -->
    </div>

    <button
      type="submit"
      id="submit-btn"
      class="w-full bg-accent hover:bg-secondary text-white font-bold py-4 rounded-xl shadow-lg shadow-blue-500/30 hover:shadow-blue-600/40 font-accent transition-all transform hover:-translate-y-1 mt-4 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"
    >
      <span id="btn-text">Enviar Mensaje</span>
      <span id="btn-loading" class="hidden">
        <svg
          class="animate-spin h-5 w-5 mx-auto"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
        >
          <circle
            class="opacity-25"
            cx="12"
            cy="12"
            r="10"
            stroke="currentColor"
            stroke-width="4"></circle>
          <path
            class="opacity-75"
            fill="currentColor"
            d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
          ></path>
        </svg>
      </span>
    </button>
  </form>
</div>

<script>
  const form = document.getElementById("contact-form") as HTMLFormElement;
  const submitBtn = document.getElementById("submit-btn") as HTMLButtonElement;
  const btnText = document.getElementById("btn-text") as HTMLSpanElement;
  const btnLoading = document.getElementById("btn-loading") as HTMLSpanElement;
  const formMessage = document.getElementById("form-message") as HTMLDivElement;

  form?.addEventListener("submit", async (e) => {
    e.preventDefault();

    const formData = new FormData(form);
    const data = {
      name: formData.get("name"),
      email: formData.get("email"),
      subject: formData.get("subject"),
      message: formData.get("message"),
    };

    submitBtn.disabled = true;
    btnText.classList.add("hidden");
    btnLoading.classList.remove("hidden");
    formMessage.classList.add("hidden");

    try {
      await new Promise((resolve) => setTimeout(resolve, 2000));
      //mensaje de éxito
      formMessage.innerHTML = `
        <div class="bg-green-50 border border-green-200 text-green-800 px-6 py-4 rounded-xl flex items-start gap-3">
          <svg class="w-6 h-6 text-green-500 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <div>
            <p class="font-bold">¡Mensaje enviado con éxito!</p>
            <p class="text-sm mt-1">Te responderemos pronto. Gracias por contactarnos.</p>
          </div>
        </div>
      `;
      formMessage.classList.remove("hidden");

      form.reset();

      setTimeout(() => {
        formMessage.classList.add("hidden");
      }, 5000);
    } catch (error) {
      //mensaje de error
      formMessage.innerHTML = `
        <div class="bg-red-50 border border-red-200 text-red-800 px-6 py-4 rounded-xl flex items-start gap-3">
          <svg class="w-6 h-6 text-red-500 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <div>
            <p class="font-bold">Error al enviar el mensaje</p>
            <p class="text-sm mt-1">Por favor, intenta nuevamente o contáctanos por WhatsApp.</p>
          </div>
        </div>
      `;
      formMessage.classList.remove("hidden");
    } finally {
      submitBtn.disabled = false;
      btnText.classList.remove("hidden");
      btnLoading.classList.add("hidden");
    }
  });
</script>
